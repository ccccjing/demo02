{"version":3,"sources":["webpack:///./src/api/article.js","webpack:///./src/views/export/excel-file.vue","webpack:///./src/utils/index.js","webpack:///src/views/export/excel-file.vue","webpack:///./src/views/export/excel-file.vue?c6d5","webpack:///./src/views/export/excel-file.vue?e226","webpack:///./src/views/export/excel-file.vue?5aa4"],"names":["getList","query","request","url","method","params","getStaffList","render","_vm","this","_c","_self","staticClass","attrs","model","value","fileName","callback","$$v","expression","downloadLoading","on","handleDownload","_v","directives","name","rawName","loading","staticStyle","tableData","pagination","currentPage","pageSize","total","handleSizeChange","handleCurrentChange","staticRenderFns","parseTime","time","cFormat","arguments","length","format","date","test","parseInt","replace","RegExp","toString","Date","formatObj","y","getFullYear","m","getMonth","d","getDate","h","getHours","i","getMinutes","s","getSeconds","a","getDay","time_str","result","key","padStart","data","methods","getData","setTimeout","catch","excel","header","filename","formatJson","mounted","component"],"mappings":"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","file":"static/js/chunk-2bc336b4.989a2eda.js","sourcesContent":["import request from '@/utils/request'\r\n\r\nexport function getList(query) {\r\n  return request({\r\n    url: '/api/article/list',\r\n    method: 'get',\r\n    params: query\r\n  })\r\n}\r\n\r\nexport function getStaffList(query) {\r\n  return request({\r\n    url: '/api/article/staffList',\r\n    method: 'get',\r\n    params: query\r\n  })\r\n}\r\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',[_c('el-input',{staticClass:\"export-input\",attrs:{\"placeholder\":\"文件名\",\"clearable\":\"\"},model:{value:(_vm.fileName),callback:function ($$v) {_vm.fileName=$$v},expression:\"fileName\"}}),_c('el-button',{staticClass:\"filter-item\",attrs:{\"loading\":_vm.downloadLoading,\"type\":\"primary\",\"icon\":\"el-icon-download\"},on:{\"click\":_vm.handleDownload}},[_vm._v(\" 导出excel文件 \")])],1),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.tableData,\"border\":\"\",\"script\":\"\",\"max-height\":\"485\"}},[_c('el-table-column',{attrs:{\"prop\":\"workNumber\",\"label\":\"工号\",\"min-width\":\"80\"}}),_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"姓名\",\"min-width\":\"150\"}}),_c('el-table-column',{attrs:{\"prop\":\"sex\",\"label\":\"性别\",\"min-width\":\"150\"}}),_c('el-table-column',{attrs:{\"prop\":\"birthday\",\"label\":\"出生日期\",\"min-width\":\"150\"}}),_c('el-table-column',{attrs:{\"prop\":\"tel\",\"label\":\"电话\",\"min-width\":\"150\"}}),_c('el-table-column',{attrs:{\"prop\":\"country\",\"label\":\"家庭住址\",\"min-width\":\"150\"}}),_c('el-table-column',{attrs:{\"prop\":\"email\",\"label\":\"邮箱\",\"min-width\":\"150\"}})],1),_c('div',{staticClass:\"page-wrapper clearfix\"},[_c('el-pagination',{attrs:{\"background\":\"\",\"page-sizes\":[10, 20, 30, 50],\"layout\":\"total, sizes, prev, pager, next, jumper\",\"current-page\":_vm.pagination.currentPage,\"page-size\":_vm.pagination.pageSize,\"total\":_vm.pagination.total},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\r\n * Created by PanJiaChen on 16/11/18.\r\n */\r\n\r\n/**\r\n * Parse the time to string\r\n * @param {(Object|string|number)} time\r\n * @param {string} cFormat\r\n * @returns {string | null}\r\n */\r\nexport function parseTime(time, cFormat) {\r\n  if (arguments.length === 0 || !time) {\r\n    return null\r\n  }\r\n  const format = cFormat || '{y}-{m}-{d} {h}:{i}:{s}'\r\n  let date\r\n  if (typeof time === 'object') {\r\n    date = time\r\n  } else {\r\n    if ((typeof time === 'string')) {\r\n      if ((/^[0-9]+$/.test(time))) {\r\n        // support \"1548221490638\"\r\n        time = parseInt(time)\r\n      } else {\r\n        // support safari\r\n        // https://stackoverflow.com/questions/4310953/invalid-date-in-safari\r\n        time = time.replace(new RegExp(/-/gm), '/')\r\n      }\r\n    }\r\n\r\n    if ((typeof time === 'number') && (time.toString().length === 10)) {\r\n      time = time * 1000\r\n    }\r\n    date = new Date(time)\r\n  }\r\n  const formatObj = {\r\n    y: date.getFullYear(),\r\n    m: date.getMonth() + 1,\r\n    d: date.getDate(),\r\n    h: date.getHours(),\r\n    i: date.getMinutes(),\r\n    s: date.getSeconds(),\r\n    a: date.getDay()\r\n  }\r\n  const time_str = format.replace(/{([ymdhisa])+}/g, (result, key) => {\r\n    const value = formatObj[key]\r\n    // Note: getDay() returns 0 on Sunday\r\n    if (key === 'a') { return ['日', '一', '二', '三', '四', '五', '六'][value ] }\r\n    return value.toString().padStart(2, '0')\r\n  })\r\n  return time_str\r\n}\r\n\r\n/**\r\n * @param {number} time\r\n * @param {string} option\r\n * @returns {string}\r\n */\r\nexport function formatTime(time, option) {\r\n  if (('' + time).length === 10) {\r\n    time = parseInt(time) * 1000\r\n  } else {\r\n    time = +time\r\n  }\r\n  const d = new Date(time)\r\n  const now = Date.now()\r\n\r\n  const diff = (now - d) / 1000\r\n\r\n  if (diff < 30) {\r\n    return '刚刚'\r\n  } else if (diff < 3600) {\r\n    // less 1 hour\r\n    return Math.ceil(diff / 60) + '分钟前'\r\n  } else if (diff < 3600 * 24) {\r\n    return Math.ceil(diff / 3600) + '小时前'\r\n  } else if (diff < 3600 * 24 * 2) {\r\n    return '1天前'\r\n  }\r\n  if (option) {\r\n    return parseTime(time, option)\r\n  } else {\r\n    return (\r\n      d.getMonth() +\r\n      1 +\r\n      '月' +\r\n      d.getDate() +\r\n      '日' +\r\n      d.getHours() +\r\n      '时' +\r\n      d.getMinutes() +\r\n      '分'\r\n    )\r\n  }\r\n}\r\n\r\n/**\r\n * @param {string} url\r\n * @returns {Object}\r\n */\r\nexport function getQueryObject(url) {\r\n  url = url == null ? window.location.href : url\r\n  const search = url.substring(url.lastIndexOf('?') + 1)\r\n  const obj = {}\r\n  const reg = /([^?&=]+)=([^?&=]*)/g\r\n  search.replace(reg, (rs, $1, $2) => {\r\n    const name = decodeURIComponent($1)\r\n    let val = decodeURIComponent($2)\r\n    val = String(val)\r\n    obj[name] = val\r\n    return rs\r\n  })\r\n  return obj\r\n}\r\n\r\n/**\r\n * @param {string} input value\r\n * @returns {number} output value\r\n */\r\nexport function byteLength(str) {\r\n  // returns the byte length of an utf8 string\r\n  let s = str.length\r\n  for (var i = str.length - 1; i >= 0; i--) {\r\n    const code = str.charCodeAt(i)\r\n    if (code > 0x7f && code <= 0x7ff) s++\r\n    else if (code > 0x7ff && code <= 0xffff) s += 2\r\n    if (code >= 0xDC00 && code <= 0xDFFF) i--\r\n  }\r\n  return s\r\n}\r\n\r\n/**\r\n * @param {Array} actual\r\n * @returns {Array}\r\n */\r\nexport function cleanArray(actual) {\r\n  const newArray = []\r\n  for (let i = 0; i < actual.length; i++) {\r\n    if (actual[i]) {\r\n      newArray.push(actual[i])\r\n    }\r\n  }\r\n  return newArray\r\n}\r\n\r\n/**\r\n * @param {Object} json\r\n * @returns {Array}\r\n */\r\nexport function param(json) {\r\n  if (!json) return ''\r\n  return cleanArray(\r\n    Object.keys(json).map(key => {\r\n      if (json[key] === undefined) return ''\r\n      return encodeURIComponent(key) + '=' + encodeURIComponent(json[key])\r\n    })\r\n  ).join('&')\r\n}\r\n\r\n/**\r\n * @param {string} url\r\n * @returns {Object}\r\n */\r\nexport function param2Obj(url) {\r\n  const search = decodeURIComponent(url.split('?')[1]).replace(/\\+/g, ' ')\r\n  if (!search) {\r\n    return {}\r\n  }\r\n  const obj = {}\r\n  const searchArr = search.split('&')\r\n  searchArr.forEach(v => {\r\n    const index = v.indexOf('=')\r\n    if (index !== -1) {\r\n      const name = v.substring(0, index)\r\n      const val = v.substring(index + 1, v.length)\r\n      obj[name] = val\r\n    }\r\n  })\r\n  return obj\r\n}\r\n\r\n/**\r\n * @param {string} val\r\n * @returns {string}\r\n */\r\nexport function html2Text(val) {\r\n  const div = document.createElement('div')\r\n  div.innerHTML = val\r\n  return div.textContent || div.innerText\r\n}\r\n\r\n/**\r\n * Merges two objects, giving the last one precedence\r\n * @param {Object} target\r\n * @param {(Object|Array)} source\r\n * @returns {Object}\r\n */\r\nexport function objectMerge(target, source) {\r\n  if (typeof target !== 'object') {\r\n    target = {}\r\n  }\r\n  if (Array.isArray(source)) {\r\n    return source.slice()\r\n  }\r\n  Object.keys(source).forEach(property => {\r\n    const sourceProperty = source[property]\r\n    if (typeof sourceProperty === 'object') {\r\n      target[property] = objectMerge(target[property], sourceProperty)\r\n    } else {\r\n      target[property] = sourceProperty\r\n    }\r\n  })\r\n  return target\r\n}\r\n\r\n/**\r\n * @param {HTMLElement} element\r\n * @param {string} className\r\n */\r\nexport function toggleClass(element, className) {\r\n  if (!element || !className) {\r\n    return\r\n  }\r\n  let classString = element.className\r\n  const nameIndex = classString.indexOf(className)\r\n  if (nameIndex === -1) {\r\n    classString += '' + className\r\n  } else {\r\n    classString =\r\n      classString.substr(0, nameIndex) +\r\n      classString.substr(nameIndex + className.length)\r\n  }\r\n  element.className = classString\r\n}\r\n\r\n/**\r\n * @param {string} type\r\n * @returns {Date}\r\n */\r\nexport function getTime(type) {\r\n  if (type === 'start') {\r\n    return new Date().getTime() - 3600 * 1000 * 24 * 90\r\n  } else {\r\n    return new Date(new Date().toDateString())\r\n  }\r\n}\r\n\r\n/**\r\n * @param {Function} func\r\n * @param {number} wait\r\n * @param {boolean} immediate\r\n * @return {*}\r\n */\r\nexport function debounce(func, wait, immediate) {\r\n  let timeout, args, context, timestamp, result\r\n\r\n  const later = function() {\r\n    // 据上一次触发时间间隔\r\n    const last = +new Date() - timestamp\r\n\r\n    // 上次被包装函数被调用时间间隔 last 小于设定时间间隔 wait\r\n    if (last < wait && last > 0) {\r\n      timeout = setTimeout(later, wait - last)\r\n    } else {\r\n      timeout = null\r\n      // 如果设定为immediate===true，因为开始边界已经调用过了此处无需调用\r\n      if (!immediate) {\r\n        result = func.apply(context, args)\r\n        if (!timeout) context = args = null\r\n      }\r\n    }\r\n  }\r\n\r\n  return function(...args) {\r\n    context = this\r\n    timestamp = +new Date()\r\n    const callNow = immediate && !timeout\r\n    // 如果延时不存在，重新设定延时\r\n    if (!timeout) timeout = setTimeout(later, wait)\r\n    if (callNow) {\r\n      result = func.apply(context, args)\r\n      context = args = null\r\n    }\r\n\r\n    return result\r\n  }\r\n}\r\n\r\n/**\r\n * This is just a simple version of deep copy\r\n * Has a lot of edge cases bug\r\n * If you want to use a perfect deep copy, use lodash's _.cloneDeep\r\n * @param {Object} source\r\n * @returns {Object}\r\n */\r\nexport function deepClone(source) {\r\n  if (!source && typeof source !== 'object') {\r\n    throw new Error('error arguments', 'deepClone')\r\n  }\r\n  const targetObj = source.constructor === Array ? [] : {}\r\n  Object.keys(source).forEach(keys => {\r\n    if (source[keys] && typeof source[keys] === 'object') {\r\n      targetObj[keys] = deepClone(source[keys])\r\n    } else {\r\n      targetObj[keys] = source[keys]\r\n    }\r\n  })\r\n  return targetObj\r\n}\r\n\r\n/**\r\n * @param {Array} arr\r\n * @returns {Array}\r\n */\r\nexport function uniqueArr(arr) {\r\n  return Array.from(new Set(arr))\r\n}\r\n\r\n/**\r\n * @returns {string}\r\n */\r\nexport function createUniqueString() {\r\n  const timestamp = +new Date() + ''\r\n  const randomNum = parseInt((1 + Math.random()) * 65536) + ''\r\n  return (+(randomNum + timestamp)).toString(32)\r\n}\r\n\r\n/**\r\n * Check if an element has a class\r\n * @param {HTMLElement} elm\r\n * @param {string} cls\r\n * @returns {boolean}\r\n */\r\nexport function hasClass(ele, cls) {\r\n  return !!ele.className.match(new RegExp('(\\\\s|^)' + cls + '(\\\\s|$)'))\r\n}\r\n\r\n/**\r\n * Add class to element\r\n * @param {HTMLElement} elm\r\n * @param {string} cls\r\n */\r\nexport function addClass(ele, cls) {\r\n  if (!hasClass(ele, cls)) ele.className += ' ' + cls\r\n}\r\n\r\n/**\r\n * Remove class from element\r\n * @param {HTMLElement} elm\r\n * @param {string} cls\r\n */\r\nexport function removeClass(ele, cls) {\r\n  if (hasClass(ele, cls)) {\r\n    const reg = new RegExp('(\\\\s|^)' + cls + '(\\\\s|$)')\r\n    ele.className = ele.className.replace(reg, ' ')\r\n  }\r\n}\r\n","<!--\r\n * @description: description\r\n * @fileName: excel-file.vue\r\n * @author: pierce\r\n * @lastDate: 2022-08-24 13:34:21\r\n!-->\r\n\r\n<template>\r\n  <div>\r\n    <div>\r\n      <el-input\r\n        v-model=\"fileName\"\r\n        placeholder=\"文件名\"\r\n        class=\"export-input\"\r\n        clearable\r\n      />\r\n      <el-button\r\n        :loading=\"downloadLoading\"\r\n        class=\"filter-item\"\r\n        type=\"primary\"\r\n        icon=\"el-icon-download\"\r\n        @click=\"handleDownload\"\r\n      >\r\n        导出excel文件\r\n      </el-button>\r\n    </div>\r\n\r\n    <el-table\r\n      :data=\"tableData\"\r\n      border\r\n      script\r\n      style=\"width: 100%\"\r\n      max-height=\"485\"\r\n      v-loading=\"loading\"\r\n    >\r\n      <el-table-column\r\n        prop=\"workNumber\"\r\n        label=\"工号\"\r\n        min-width=\"80\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        prop=\"name\"\r\n        label=\"姓名\"\r\n        min-width=\"150\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        prop=\"sex\"\r\n        label=\"性别\"\r\n        min-width=\"150\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        prop=\"birthday\"\r\n        label=\"出生日期\"\r\n        min-width=\"150\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        prop=\"tel\"\r\n        label=\"电话\"\r\n        min-width=\"150\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        prop=\"country\"\r\n        label=\"家庭住址\"\r\n        min-width=\"150\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        prop=\"email\"\r\n        label=\"邮箱\"\r\n        min-width=\"150\"\r\n      ></el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 分页 -->\r\n    <div class=\"page-wrapper clearfix\">\r\n      <el-pagination\r\n        background\r\n        :page-sizes=\"[10, 20, 30, 50]\"\r\n        layout=\"total, sizes, prev, pager, next, jumper\"\r\n        @size-change=\"handleSizeChange\"\r\n        @current-change=\"handleCurrentChange\"\r\n        :current-page=\"pagination.currentPage\"\r\n        :page-size=\"pagination.pageSize\"\r\n        :total=\"pagination.total\"\r\n      ></el-pagination>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getStaffList } from '@/api/article'\r\nimport { parseTime } from '@/utils'\r\n// import { export_json_to_excel } from '@/utils/Export2Excel'\r\n\r\nexport default {\r\n  name: 'ExcelFile',\r\n  data () {\r\n    return {\r\n      loading: false,\r\n      downloadLoading: false,\r\n      tableData: [],\r\n      params: {},\r\n      pagination: { /// 分页参数\r\n        currentPage: 1,\r\n        pageSize: 10,\r\n        total: 0\r\n      },\r\n      fileName: ''\r\n    }\r\n  },\r\n  methods: {\r\n    getData() {\r\n      let query = {\r\n        ...this.params,\r\n        ...this.pagination\r\n      }\r\n      delete query.total\r\n      this.loading = true\r\n\r\n      // 获取数据\r\n      getStaffList(query).then((res) => {\r\n        this.tableData = res.data.items,\r\n        this.pagination.total = res.data.total\r\n\r\n        setTimeout(() => {\r\n          this.loading = false\r\n        }, 1.5 * 1000)\r\n\r\n      }).catch(() => {\r\n        this.loading = false\r\n      })\r\n    },\r\n    // 当前页大小\r\n    handleSizeChange(val) {\r\n      this.pagination.pageSize = 1\r\n      this.pagination.pageSize = val\r\n      this.getData()\r\n    },\r\n    // 当前页\r\n    handleCurrentChange(val) {\r\n      this.pagination.currentPage = val\r\n      this.getData()\r\n    },\r\n    handleDownload() {\r\n      this.downloadLoading = true\r\n\r\n      import('@/utils/Export2Excel').then(excel => {\r\n        const tHeader = [\r\n          '工号',\r\n          '姓名',\r\n          '性别',\r\n          '出生日期',\r\n          '电话',\r\n          '家庭住址',\r\n          '邮箱'\r\n        ]\r\n        const filterVal = [\r\n          'workNumber',\r\n          'name',\r\n          'sex',\r\n          'birthday',\r\n          'tel',\r\n          'country',\r\n          'email',\r\n        ]\r\n        const list = this.tableData\r\n        const data = this.formatJson(filterVal, list)\r\n        const filename = this.fileName\r\n\r\n        excel.export_json_to_excel({\r\n          header: tHeader,\r\n          data,\r\n          filename\r\n        })\r\n\r\n        this.downloadLoading = false\r\n      })\r\n    },\r\n    formatJson(filterVal, jsonData) {\r\n      return jsonData.map(v => filterVal.map(j => {\r\n        if (j === 'timestamp') {\r\n          return parseTime(v[j])\r\n        } else {\r\n          return v[j]\r\n        }\r\n      }))\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getData()\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.export-input {\r\n  width: 180px;\r\n  margin-right: 6px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./excel-file.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./excel-file.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./excel-file.vue?vue&type=template&id=d0b61f26&scoped=true&\"\nimport script from \"./excel-file.vue?vue&type=script&lang=js&\"\nexport * from \"./excel-file.vue?vue&type=script&lang=js&\"\nimport style0 from \"./excel-file.vue?vue&type=style&index=0&id=d0b61f26&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d0b61f26\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./excel-file.vue?vue&type=style&index=0&id=d0b61f26&prod&lang=scss&scoped=true&\""],"sourceRoot":""}