{"version":3,"sources":["webpack:///./src/views/export/word-file.vue","webpack:///src/views/export/word-file.vue","webpack:///./src/views/export/word-file.vue?e4a0","webpack:///./src/views/export/word-file.vue?3012"],"names":["render","_vm","this","_c","_self","ref","staticClass","attrs","rules","workForm","model","value","fileName","callback","$$v","$set","expression","company","name","sex","politicalOutlook","idNumber","on","getDate","date","department","work","$event","submitForm","_v","resetForm","staticRenderFns","data","startTime","endTime","max","message","trigger","required","methods","console","exportWord","JSZipUtils","doc","stack","properties","error","type","mineType","saveAs","component"],"mappings":"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","file":"static/js/chunk-2d20e816.ce5d8e11.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('el-form',{ref:\"workForm\",staticClass:\"demo-ruleForm\",attrs:{\"rules\":_vm.rules,\"model\":_vm.workForm,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"导出文件名\",\"prop\":\"fileName\"}},[_c('el-input',{attrs:{\"clearable\":\"\"},model:{value:(_vm.workForm.fileName),callback:function ($$v) {_vm.$set(_vm.workForm, \"fileName\", $$v)},expression:\"workForm.fileName\"}})],1),_c('el-form-item',{attrs:{\"label\":\"单位\",\"prop\":\"company\"}},[_c('el-input',{attrs:{\"clearable\":\"\"},model:{value:(_vm.workForm.company),callback:function ($$v) {_vm.$set(_vm.workForm, \"company\", $$v)},expression:\"workForm.company\"}})],1),_c('el-form-item',{attrs:{\"label\":\"姓名\",\"prop\":\"name\"}},[_c('el-input',{attrs:{\"clearable\":\"\"},model:{value:(_vm.workForm.name),callback:function ($$v) {_vm.$set(_vm.workForm, \"name\", $$v)},expression:\"workForm.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"性别\",\"prop\":\"sex\"}},[_c('el-select',{attrs:{\"clearable\":\"\"},model:{value:(_vm.workForm.sex),callback:function ($$v) {_vm.$set(_vm.workForm, \"sex\", $$v)},expression:\"workForm.sex\"}},[_c('el-option',{attrs:{\"label\":\"男\",\"value\":\"男\"}}),_c('el-option',{attrs:{\"label\":\"女\",\"value\":\"女\"}})],1)],1),_c('el-form-item',{attrs:{\"label\":\"政治面貌\",\"prop\":\"politicalOutlook\"}},[_c('el-input',{attrs:{\"clearable\":\"\"},model:{value:(_vm.workForm.politicalOutlook),callback:function ($$v) {_vm.$set(_vm.workForm, \"politicalOutlook\", $$v)},expression:\"workForm.politicalOutlook\"}})],1),_c('el-form-item',{attrs:{\"label\":\"身份证号\",\"prop\":\"idNumber\"}},[_c('el-input',{attrs:{\"clearable\":\"\"},model:{value:(_vm.workForm.idNumber),callback:function ($$v) {_vm.$set(_vm.workForm, \"idNumber\", $$v)},expression:\"workForm.idNumber\"}})],1),_c('el-form-item',{attrs:{\"label\":\"时间\",\"prop\":\"date\"}},[_c('el-date-picker',{attrs:{\"type\":\"daterange\",\"unlink-panels\":\"\",\"range-separator\":\"至\",\"start-placeholder\":\"开始日期\",\"end-placeholder\":\"结束日期\",\"value-format\":\"yyyy/MM/dd\",\"clearable\":\"\"},on:{\"change\":_vm.getDate},model:{value:(_vm.workForm.date),callback:function ($$v) {_vm.$set(_vm.workForm, \"date\", $$v)},expression:\"workForm.date\"}})],1),_c('el-form-item',{attrs:{\"label\":\"部门\",\"prop\":\"department\"}},[_c('el-input',{attrs:{\"clearable\":\"\"},model:{value:(_vm.workForm.department),callback:function ($$v) {_vm.$set(_vm.workForm, \"department\", $$v)},expression:\"workForm.department\"}})],1),_c('el-form-item',{attrs:{\"label\":\"职位\",\"prop\":\"work\"}},[_c('el-input',{attrs:{\"clearable\":\"\"},model:{value:(_vm.workForm.work),callback:function ($$v) {_vm.$set(_vm.workForm, \"work\", $$v)},expression:\"workForm.work\"}})],1),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submitForm()}}},[_vm._v(\"导出\")]),_c('el-button',{on:{\"click\":function($event){return _vm.resetForm()}}},[_vm._v(\"重置\")])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\r\n * @description: description\r\n * @fileName: word-file.vue\r\n * @author: pierce\r\n * @lastDate: 2022-08-24 13:22:08\r\n!-->\r\n\r\n<template>\r\n  <el-form ref=\"workForm\" :rules=\"rules\" :model=\"workForm\" label-width=\"100px\" class=\"demo-ruleForm\">\r\n    <el-form-item label=\"导出文件名\" prop=\"fileName\">\r\n      <el-input v-model=\"workForm.fileName\" clearable></el-input>\r\n    </el-form-item>\r\n    <el-form-item label=\"单位\" prop=\"company\">\r\n      <el-input v-model=\"workForm.company\" clearable></el-input>\r\n    </el-form-item>\r\n    <el-form-item label=\"姓名\" prop=\"name\">\r\n      <el-input v-model=\"workForm.name\" clearable></el-input>\r\n    </el-form-item>\r\n    <el-form-item label=\"性别\" prop=\"sex\">\r\n      <el-select v-model=\"workForm.sex\" clearable>\r\n        <el-option label=\"男\" value=\"男\"></el-option>\r\n        <el-option label=\"女\" value=\"女\"></el-option>\r\n      </el-select>\r\n    </el-form-item>\r\n    <el-form-item label=\"政治面貌\" prop=\"politicalOutlook\">\r\n      <el-input v-model=\"workForm.politicalOutlook\" clearable></el-input>\r\n    </el-form-item>\r\n    <el-form-item label=\"身份证号\" prop=\"idNumber\">\r\n      <el-input v-model=\"workForm.idNumber\" clearable></el-input>\r\n    </el-form-item>\r\n    <el-form-item label=\"时间\" prop=\"date\">\r\n      <el-date-picker\r\n        v-model=\"workForm.date\"\r\n        type=\"daterange\"\r\n        unlink-panels\r\n        range-separator=\"至\"\r\n        start-placeholder=\"开始日期\"\r\n        end-placeholder=\"结束日期\"\r\n        value-format=\"yyyy/MM/dd\"\r\n        @change=\"getDate\"\r\n        clearable\r\n      ></el-date-picker>\r\n    </el-form-item>\r\n    <el-form-item label=\"部门\" prop=\"department\">\r\n      <el-input v-model=\"workForm.department\" clearable></el-input>\r\n    </el-form-item>\r\n    <el-form-item label=\"职位\" prop=\"work\">\r\n      <el-input v-model=\"workForm.work\" clearable></el-input>\r\n    </el-form-item>\r\n    <el-button type=\"primary\" @click=\"submitForm()\">导出</el-button>\r\n    <el-button @click=\"resetForm()\">重置</el-button>\r\n  </el-form>\r\n</template>\r\n\r\n<script>\r\nimport docxtemplater from 'docxtemplater'\r\nimport PizZip from 'pizzip'\r\nimport JSZipUtils from 'jszip-utils'\r\nimport { saveAs } from 'file-saver'\r\n\r\nexport default {\r\n  name: 'WordFile',\r\n  data () {\r\n    return {\r\n      workForm: {\r\n        fileName: '',\r\n        company: '',\r\n        name: '',\r\n        sex: '',\r\n        politicalOutlook: '',\r\n        idNumber: '',\r\n        date: '',\r\n        startTime: '',\r\n        endTime: '',\r\n        department: '',\r\n        work: '',\r\n      },\r\n      rules: {\r\n        fileName: [\r\n          { max: 50, message: '不超过50个字符', trigger: 'blur' }\r\n        ],\r\n        company: [\r\n          { required: true, message: '请输入单位', trigger: 'blur' },\r\n          { max: 50, message: '不超过50个字符', trigger: 'blur' }\r\n        ],\r\n        name: [\r\n          { required: true, message: '请输入姓名', trigger: 'blur' },\r\n          { max: 50, message: '不超过50个字符', trigger: 'blur' }\r\n        ],\r\n        sex: [\r\n          { required: true, message: '请选择性别', trigger: 'change' }\r\n        ],\r\n        politicalOutlook: [\r\n          { required: true, message: '请输入政治面貌', trigger: 'blur' },\r\n          { max: 50, message: '不超过50个字符', trigger: 'blur' }\r\n        ],\r\n        idNumber: [\r\n          { required: true, message: '请输入身份证号', trigger: 'blur' },\r\n          { max: 50, message: '不超过50个字符', trigger: 'blur' }\r\n        ],\r\n        date: [\r\n          { required: true, message: '请选择日期', trigger: 'change' },\r\n        ],\r\n        department: [\r\n          { required: true, message: '请输入部门', trigger: 'blur' },\r\n          { max: 50, message: '不超过50个字符', trigger: 'blur' }\r\n        ],\r\n        work: [\r\n          { required: true, message: '请输入职位', trigger: 'blur' },\r\n          { max: 50, message: '不超过50个字符', trigger: 'blur' }\r\n        ],\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    // 计算出带年月日的时间\r\n    getDate() {\r\n      console.log(this.workForm.date)\r\n      let startTime = this.workForm.date[0]\r\n      startTime = startTime.replace('/', '年')\r\n      startTime = startTime.replace('/', '月') + '日'\r\n      this.workForm.startTime = startTime\r\n\r\n      let endTime = this.workForm.date[1]\r\n      endTime = endTime.replace('/', '年')\r\n      endTime = endTime.replace('/', '月') + '日'\r\n      this.workForm.endTime = endTime\r\n    },\r\n    // 导出word文件\r\n    exportWord(data) {\r\n      // 模板\r\n      let docxsrc = '/work.docx'\r\n      // 导出文件名\r\n      let docxName = data.fileName ? data.fileName + '.docx' : '工作证明.docx'\r\n\r\n      // 读取模板并转为二进制\r\n      JSZipUtils.getBinaryContent(docxsrc, function(error, content) {\r\n        if(error) {\r\n          throw error\r\n        }\r\n        \r\n        // 创建pizzip实例，内容为模板的内容\r\n        let zip = new PizZip(content)\r\n        // 创建并加载docxtemplater实例\r\n        let doc = new docxtemplater().loadZip(zip)\r\n        // 设置模板变量的值\r\n        doc.setData({\r\n          ...data\r\n        })\r\n\r\n        try {\r\n          // 用模板变量的值替换所有模板变量\r\n          doc.render()\r\n        } catch(error) {\r\n          let e = {\r\n            message: error.message,\r\n            name: error.name,\r\n            stack: error.stack,\r\n            properties: error.properties\r\n          }\r\n          console.log(JSON.stringify({ error: e }))\r\n          throw error\r\n        }\r\n\r\n        // 生成一个代表docxtemplater对象的zip文件\r\n        let out = doc.getZip().generate({\r\n          type: 'blob',\r\n          mineType: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\r\n        })\r\n\r\n        // 将目标文件对象保存为目标类型的文件，并命名\r\n        saveAs(out, docxName)\r\n      })\r\n    },\r\n    // 导出前校验\r\n    submitForm() {\r\n      this.$refs.workForm.validate((valid) => {\r\n        if (valid) {\r\n          this.exportWord(this.workForm)\r\n        } else {\r\n          console.log('error submit!!');\r\n          return false;\r\n        }\r\n      })\r\n    },\r\n    // 重置\r\n    resetForm() {\r\n      this.$refs.workForm.resetFields()\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./word-file.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./word-file.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./word-file.vue?vue&type=template&id=178c51d1&\"\nimport script from \"./word-file.vue?vue&type=script&lang=js&\"\nexport * from \"./word-file.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}