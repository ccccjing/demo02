(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9e9b86d8"],{2423:function(t,a,e){"use strict";e.d(a,"a",(function(){return i})),e.d(a,"b",(function(){return l}));var n=e("b775");function i(t){return Object(n["a"])({url:"/api/article/list",method:"get",params:t})}function l(t){return Object(n["a"])({url:"/api/article/staffList",method:"get",params:t})}},"3f7b":function(t,a,e){"use strict";e("7308")},7308:function(t,a,e){},"8bd5":function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t._self._c;return a("div",[a("div",[a("el-input",{staticClass:"export-input",attrs:{placeholder:"文件名",clearable:""},model:{value:t.fileName,callback:function(a){t.fileName=a},expression:"fileName"}}),a("el-button",{staticClass:"filter-item",attrs:{loading:t.downloadLoading,type:"primary",icon:"el-icon-download"},on:{click:function(a){return t.handleDownload(t.tableData)}}},[t._v(" 导出word文件 ")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",script:"",height:"485"}},[a("el-table-column",{attrs:{prop:"id",label:"序号","min-width":"50"}}),a("el-table-column",{attrs:{prop:"name",label:"姓名","min-width":"150"}}),a("el-table-column",{attrs:{prop:"sex",label:"性别","min-width":"150"}}),a("el-table-column",{attrs:{prop:"tel",label:"电话","min-width":"150"}}),a("el-table-column",{attrs:{prop:"datetime",label:"时间","min-width":"150"}})],1),a("div",{staticClass:"page-wrapper clearfix"},[a("el-pagination",{attrs:{background:"","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper","current-page":t.pagination.currentPage,"page-size":t.pagination.pageSize,total:t.pagination.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)},i=[],l=e("2423"),o=e("fbf9"),r=e.n(o),s=e("547c"),c=e.n(s),d=e("0083"),p=e.n(d),g=e("21a6"),u={name:"WordTableFile",data(){return{loading:!1,downloadLoading:!1,tableData:[],params:{},pagination:{currentPage:1,pageSize:10,total:0},fileName:""}},methods:{getData(){let t={...this.params,...this.pagination};delete t.total,this.loading=!0,Object(l["a"])(t).then(t=>{this.tableData=t.data.items,this.pagination.total=t.data.total,setTimeout(()=>{this.loading=!1},1500)}).catch(()=>{this.loading=!1})},handleSizeChange(t){this.pagination.pageSize=1,this.pagination.pageSize=t,this.getData()},handleCurrentChange(t){this.pagination.currentPage=t,this.getData()},handleDownload(t){let a="/table.docx",e=this.fileName?this.fileName+".docx":"表格数据.docx";p.a.getBinaryContent(a,(function(a,n){if(a)throw a;let i=new c.a(n),l=(new r.a).loadZip(i);l.setData({table:t});try{l.render()}catch(a){let t={message:a.message,name:a.name,stack:a.stack,properties:a.properties};throw console.log(JSON.stringify({error:t})),a}let o=l.getZip().generate({type:"blob",mineType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});Object(g["saveAs"])(o,e)}))}},mounted(){this.getData()},activated(){console.log("activated")},deactivated(){console.log("deactivated")}},h=u,m=(e("3f7b"),e("2877")),b=Object(m["a"])(h,n,i,!1,null,"0e82345a",null);a["default"]=b.exports}}]);
//# sourceMappingURL=chunk-9e9b86d8.64db7e49.js.map