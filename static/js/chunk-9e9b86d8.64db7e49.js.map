{"version":3,"sources":["webpack:///./src/api/article.js","webpack:///./src/views/export/word-table-file.vue?07f7","webpack:///./src/views/export/word-table-file.vue","webpack:///src/views/export/word-table-file.vue","webpack:///./src/views/export/word-table-file.vue?0e05","webpack:///./src/views/export/word-table-file.vue?b396"],"names":["getList","query","request","url","method","params","getStaffList","render","_vm","this","_c","_self","staticClass","attrs","model","value","fileName","callback","$$v","expression","downloadLoading","on","$event","handleDownload","tableData","_v","directives","name","rawName","loading","staticStyle","pagination","currentPage","pageSize","total","handleSizeChange","handleCurrentChange","staticRenderFns","data","methods","getData","setTimeout","catch","JSZipUtils","doc","table","message","stack","properties","console","error","type","mineType","saveAs","mounted","activated","deactivated","component"],"mappings":"gHAAA,oFAEO,SAASA,EAAQC,GACtB,OAAOC,eAAQ,CACbC,IAAK,oBACLC,OAAQ,MACRC,OAAQJ,IAIL,SAASK,EAAaL,GAC3B,OAAOC,eAAQ,CACbC,IAAK,yBACLC,OAAQ,MACRC,OAAQJ,M,oCCdZ,W,kECAA,IAAIM,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACA,EAAG,MAAM,CAACA,EAAG,WAAW,CAACE,YAAY,eAAeC,MAAM,CAAC,YAAc,MAAM,UAAY,IAAIC,MAAM,CAACC,MAAOP,EAAIQ,SAAUC,SAAS,SAAUC,GAAMV,EAAIQ,SAASE,GAAKC,WAAW,cAAcT,EAAG,YAAY,CAACE,YAAY,cAAcC,MAAM,CAAC,QAAUL,EAAIY,gBAAgB,KAAO,UAAU,KAAO,oBAAoBC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOd,EAAIe,eAAef,EAAIgB,cAAc,CAAChB,EAAIiB,GAAG,iBAAiB,GAAGf,EAAG,WAAW,CAACgB,WAAW,CAAC,CAACC,KAAK,UAAUC,QAAQ,YAAYb,MAAOP,EAAIqB,QAASV,WAAW,YAAYW,YAAY,CAAC,MAAQ,QAAQjB,MAAM,CAAC,KAAOL,EAAIgB,UAAU,OAAS,GAAG,OAAS,GAAG,OAAS,QAAQ,CAACd,EAAG,kBAAkB,CAACG,MAAM,CAAC,KAAO,KAAK,MAAQ,KAAK,YAAY,QAAQH,EAAG,kBAAkB,CAACG,MAAM,CAAC,KAAO,OAAO,MAAQ,KAAK,YAAY,SAASH,EAAG,kBAAkB,CAACG,MAAM,CAAC,KAAO,MAAM,MAAQ,KAAK,YAAY,SAASH,EAAG,kBAAkB,CAACG,MAAM,CAAC,KAAO,MAAM,MAAQ,KAAK,YAAY,SAASH,EAAG,kBAAkB,CAACG,MAAM,CAAC,KAAO,WAAW,MAAQ,KAAK,YAAY,UAAU,GAAGH,EAAG,MAAM,CAACE,YAAY,yBAAyB,CAACF,EAAG,gBAAgB,CAACG,MAAM,CAAC,WAAa,GAAG,aAAa,CAAC,GAAI,GAAI,GAAI,IAAI,OAAS,0CAA0C,eAAeL,EAAIuB,WAAWC,YAAY,YAAYxB,EAAIuB,WAAWE,SAAS,MAAQzB,EAAIuB,WAAWG,OAAOb,GAAG,CAAC,cAAcb,EAAI2B,iBAAiB,iBAAiB3B,EAAI4B,wBAAwB,IAAI,IAEz6CC,EAAkB,G,uFCmFP,GACfV,qBACAW,OACA,OACAT,WACAT,mBACAI,aACAnB,UACA0B,YACAC,cACAC,YACAC,SAEAlB,cAGAuB,SACAC,UACA,UACA,eACA,wBAEA,QACA,gBAGAxC,2BACA,4BACA,mCAEAyC,gBACA,iBACA,QAEAC,MAAA,KACA,mBAIAP,oBACA,2BACA,2BACA,gBAGAC,uBACA,8BACA,gBAGAb,kBAEA,oBAEA,kDAGAoB,sCACA,KACA,QAIA,iBAEA,uBAEAC,WACAC,UAIA,IACAD,WACA,SACA,OACAE,kBACAnB,YACAoB,cACAC,yBAIA,MADAC,4BAAAC,WACA,EAIA,2BACAC,YACAC,qFAIAC,8BAKAC,UACA,gBAEAC,YACAN,0BAEAO,cACAP,6BC9LwW,I,wBCQpWQ,EAAY,eACd,EACAlD,EACA8B,GACA,EACA,KACA,WACA,MAIa,aAAAoB,E","file":"static/js/chunk-9e9b86d8.64db7e49.js","sourcesContent":["import request from '@/utils/request'\r\n\r\nexport function getList(query) {\r\n  return request({\r\n    url: '/api/article/list',\r\n    method: 'get',\r\n    params: query\r\n  })\r\n}\r\n\r\nexport function getStaffList(query) {\r\n  return request({\r\n    url: '/api/article/staffList',\r\n    method: 'get',\r\n    params: query\r\n  })\r\n}\r\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./word-table-file.vue?vue&type=style&index=0&id=0e82345a&prod&lang=scss&scoped=true&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',[_c('el-input',{staticClass:\"export-input\",attrs:{\"placeholder\":\"文件名\",\"clearable\":\"\"},model:{value:(_vm.fileName),callback:function ($$v) {_vm.fileName=$$v},expression:\"fileName\"}}),_c('el-button',{staticClass:\"filter-item\",attrs:{\"loading\":_vm.downloadLoading,\"type\":\"primary\",\"icon\":\"el-icon-download\"},on:{\"click\":function($event){return _vm.handleDownload(_vm.tableData)}}},[_vm._v(\" 导出word文件 \")])],1),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.tableData,\"border\":\"\",\"script\":\"\",\"height\":\"485\"}},[_c('el-table-column',{attrs:{\"prop\":\"id\",\"label\":\"序号\",\"min-width\":\"50\"}}),_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":\"姓名\",\"min-width\":\"150\"}}),_c('el-table-column',{attrs:{\"prop\":\"sex\",\"label\":\"性别\",\"min-width\":\"150\"}}),_c('el-table-column',{attrs:{\"prop\":\"tel\",\"label\":\"电话\",\"min-width\":\"150\"}}),_c('el-table-column',{attrs:{\"prop\":\"datetime\",\"label\":\"时间\",\"min-width\":\"150\"}})],1),_c('div',{staticClass:\"page-wrapper clearfix\"},[_c('el-pagination',{attrs:{\"background\":\"\",\"page-sizes\":[10, 20, 30, 50],\"layout\":\"total, sizes, prev, pager, next, jumper\",\"current-page\":_vm.pagination.currentPage,\"page-size\":_vm.pagination.pageSize,\"total\":_vm.pagination.total},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\r\n * @description: description\r\n * @fileName: word-table-file.vue\r\n * @author: pierce\r\n * @lastDate: 2022-09-01 08:51:21\r\n!-->\r\n\r\n<template>\r\n  <div>\r\n    <div>\r\n      <el-input\r\n        v-model=\"fileName\"\r\n        placeholder=\"文件名\"\r\n        class=\"export-input\"\r\n        clearable\r\n      />\r\n      <el-button\r\n        :loading=\"downloadLoading\"\r\n        class=\"filter-item\"\r\n        type=\"primary\"\r\n        icon=\"el-icon-download\"\r\n        @click=\"handleDownload(tableData)\"\r\n      >\r\n        导出word文件\r\n      </el-button>\r\n    </div>\r\n\r\n    <el-table\r\n      :data=\"tableData\"\r\n      border\r\n      script\r\n      style=\"width: 100%\"\r\n      height=\"485\"\r\n      v-loading=\"loading\"\r\n    >\r\n      <el-table-column\r\n        prop=\"id\"\r\n        label=\"序号\"\r\n        min-width=\"50\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        prop=\"name\"\r\n        label=\"姓名\"\r\n        min-width=\"150\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        prop=\"sex\"\r\n        label=\"性别\"\r\n        min-width=\"150\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        prop=\"tel\"\r\n        label=\"电话\"\r\n        min-width=\"150\"\r\n      ></el-table-column>\r\n      <el-table-column\r\n        prop=\"datetime\"\r\n        label=\"时间\"\r\n        min-width=\"150\"\r\n      ></el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 分页 -->\r\n    <div class=\"page-wrapper clearfix\">\r\n      <el-pagination\r\n        background\r\n        :page-sizes=\"[10, 20, 30, 50]\"\r\n        layout=\"total, sizes, prev, pager, next, jumper\"\r\n        @size-change=\"handleSizeChange\"\r\n        @current-change=\"handleCurrentChange\"\r\n        :current-page=\"pagination.currentPage\"\r\n        :page-size=\"pagination.pageSize\"\r\n        :total=\"pagination.total\"\r\n      ></el-pagination>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getList } from '@/api/article'\r\nimport docxtemplater from 'docxtemplater'\r\nimport PizZip from 'pizzip'\r\nimport JSZipUtils from 'jszip-utils'\r\nimport { saveAs } from 'file-saver'\r\n\r\nexport default {\r\n  name: 'WordTableFile',\r\n  data () {\r\n    return {\r\n      loading: false,\r\n      downloadLoading: false,\r\n      tableData: [],\r\n      params: {},\r\n      pagination: { /// 分页参数\r\n        currentPage: 1,\r\n        pageSize: 10,\r\n        total: 0\r\n      },\r\n      fileName: ''\r\n    }\r\n  },\r\n  methods: {\r\n    getData() {\r\n      let query = {\r\n        ...this.params,\r\n        ...this.pagination\r\n      }\r\n      delete query.total\r\n      this.loading = true\r\n\r\n      // 获取数据\r\n      getList(query).then((res) => {\r\n        this.tableData = res.data.items,\r\n        this.pagination.total = res.data.total\r\n\r\n        setTimeout(() => {\r\n          this.loading = false\r\n        }, 1.5 * 1000)\r\n\r\n      }).catch(() => {\r\n        this.loading = false\r\n      })\r\n    },\r\n    // 当前页大小\r\n    handleSizeChange(val) {\r\n      this.pagination.pageSize = 1\r\n      this.pagination.pageSize = val\r\n      this.getData()\r\n    },\r\n    // 当前页\r\n    handleCurrentChange(val) {\r\n      this.pagination.currentPage = val\r\n      this.getData()\r\n    },\r\n    // 导出数据\r\n    handleDownload(data) {\r\n      // 模板文件\r\n      let docxsrc = '/table.docx'\r\n      // 导出文件名\r\n      let docxName = this.fileName ? this.fileName + '.docx' : '表格数据.docx'\r\n\r\n      // 读取模板并转为二进制\r\n      JSZipUtils.getBinaryContent(docxsrc, function(error, content) {\r\n        if (error) {\r\n          throw error\r\n        }\r\n\r\n        // 创建pizzip实例，内容为模板内容\r\n        let zip = new PizZip(content)\r\n        // 创建并加载docxtemplater实例\r\n        let doc = new docxtemplater().loadZip(zip)\r\n        // 设置模板变量值\r\n        doc.setData({\r\n          table: data\r\n        })\r\n\r\n        // 将模板变量的值进行替换\r\n        try {\r\n          doc.render()\r\n        } catch (error) {\r\n          let e = {\r\n            message: error.message,\r\n            name: error.name,\r\n            stack: error.stack,\r\n            properties: error.properties\r\n          }\r\n          \r\n          console.log(JSON.stringify({ error: e }))\r\n          throw error\r\n        }\r\n\r\n        // 生成一个代表docxtemplater对象的zip文件\r\n        let out = doc.getZip().generate({\r\n          type: 'blob',\r\n          mineType: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\r\n        })\r\n\r\n        // 将目标文件的对象保存为目标类型的文件，并命名\r\n        saveAs(out, docxName)\r\n      })\r\n      \r\n    }\r\n  },\r\n  mounted() {\r\n    this.getData()\r\n  },\r\n  activated() {\r\n    console.log('activated')\r\n  },\r\n  deactivated() {\r\n    console.log('deactivated')\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.export-input {\r\n  width: 180px;\r\n  margin-right: 6px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./word-table-file.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./word-table-file.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./word-table-file.vue?vue&type=template&id=0e82345a&scoped=true&\"\nimport script from \"./word-table-file.vue?vue&type=script&lang=js&\"\nexport * from \"./word-table-file.vue?vue&type=script&lang=js&\"\nimport style0 from \"./word-table-file.vue?vue&type=style&index=0&id=0e82345a&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0e82345a\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}